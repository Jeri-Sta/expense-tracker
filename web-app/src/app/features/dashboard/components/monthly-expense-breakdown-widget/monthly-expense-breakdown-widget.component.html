<div class="breakdown-section surface-card shadow-2 border-round-lg">
  <div class="section-header p-4 border-bottom-1 surface-border">
    <div class="flex justify-content-between align-items-center">
      <div>
        <h3 class="text-lg font-bold text-color m-0">Totais do Mês</h3>
        <p class="text-color-secondary m-0 text-sm">
          Resumo de despesas de {{ selectedMonthName }} de {{ selectedYear }}
        </p>
      </div>
      <span class="pi pi-chart-bar text-primary text-2xl"></span>
    </div>
  </div>

  <div class="breakdown-content p-4">
    <!-- Loading State -->
    <div *ngIf="isLoading" class="flex flex-column gap-3">
      <p-skeleton height="3rem" styleClass="mb-2"></p-skeleton>
      <p-skeleton height="3rem" styleClass="mb-2"></p-skeleton>
      <p-skeleton height="3rem"></p-skeleton>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && !hasItems" class="empty-state text-center p-4">
      <i class="pi pi-inbox text-4xl text-color-secondary mb-3"></i>
      <p class="text-color-secondary m-0">Nenhuma despesa registrada neste mês</p>
    </div>

    <!-- Breakdown List -->
    <div *ngIf="!isLoading && hasItems" class="breakdown-list">
      <!-- Items (excluding total) -->
      <div 
        *ngFor="let item of itemsWithoutTotal; let last = last"
        class="breakdown-item flex align-items-center justify-content-between p-3 mb-2 surface-hover border-round"
      >
        <div class="flex align-items-center gap-3">
          <!-- Type Icon with Color -->
          <div 
            class="item-icon flex align-items-center justify-content-center border-round"
            [style.background-color]="item.color || '#607D8B'"
            [style.width.px]="40"
            [style.height.px]="40"
          >
            <i [class]="getIconForType(item)" class="text-white text-lg"></i>
          </div>
          
          <!-- Name and Type Label -->
          <div class="flex flex-column">
            <span class="font-semibold text-color">{{ item.name }}</span>
            <span class="text-xs text-color-secondary">{{ getTypeLabel(item.type) }}</span>
          </div>
        </div>

        <!-- Amount and Discount Badge -->
        <div class="flex align-items-center gap-2">
          <!-- Discount Badge (if exists) -->
          <span 
            *ngIf="item.discountAmount && item.discountAmount > 0" 
            class="discount-badge text-xs bg-green-100 text-green-700 px-2 py-1 border-round-lg font-semibold"
            pTooltip="Economia com pagamento antecipado"
            tooltipPosition="left"
          >
            -{{ formatCurrency(item.discountAmount) }}
          </span>
          
          <!-- Amount -->
          <span class="font-bold text-lg text-color">
            {{ formatCurrency(item.amount) }}
          </span>
        </div>
      </div>

      <!-- Total Row (with separator) -->
      <div *ngIf="totalItem" class="total-row mt-3 pt-3 border-top-1 surface-border">
        <div class="flex align-items-center justify-content-between p-3 surface-section border-round">
          <div class="flex align-items-center gap-3">
            <div 
              class="item-icon flex align-items-center justify-content-center border-round bg-primary"
              [style.width.px]="40"
              [style.height.px]="40"
            >
              <i [class]="getIconForType(totalItem)" class="text-white text-lg"></i>
            </div>
            <span class="font-bold text-lg text-color">{{ totalItem.name }}</span>
          </div>
          <span class="font-bold text-xl text-primary">
            {{ formatCurrency(totalItem.amount) }}
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
